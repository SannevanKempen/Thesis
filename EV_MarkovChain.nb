(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32208,        703]
NotebookOptionsPosition[     31600,        682]
NotebookOutlinePosition[     31994,        699]
CellTagsIndexPosition[     31951,        696]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Two", " ", "nodes", " ", "with", " ", "matlab", " ", "help"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Use", " ", 
    RowBox[{"matlab", " ", "'"}], 
    RowBox[{"LambdaMatrixGenerator", "'"}], " ", "to", " ", "solve", " ", 
    "CVX", " ", "optimization", " ", "problems", " ", "to", " ", "find", " ", 
    "LambdaStars"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Import", " ", "result", " ", "from", " ", "folder", " ", 
    "LambdaMatrices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Add", " ", "'"}], 
    RowBox[{"_sun", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gen", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nu", "=", "1"}], ";", 
    RowBox[{"mu", "=", "1"}], ";", 
    RowBox[{"lambda", "=", 
     RowBox[{"12", "*", "K"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"method", "=", "0"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"0", " ", "MOD"}], ";", " ", 
      RowBox[{"1", " ", "LDF"}], ";", " ", 
      RowBox[{"2", " ", "SOCP"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"method", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"filename", " ", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{
         "\"\</Users/Ingrid/Documents/Github/Thesis/LambdaMatrices/mod`1`_`2`.\
mat\>\"", ",", "K", ",", "gen"}], "]"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"method", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"filename", " ", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\</Users/Ingrid/Documents/Github/Thesis/LambdaMatrices/ldf`1`_`\
2`.mat\>\"", ",", "K", ",", "gen"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"filename", " ", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\</Users/Ingrid/Documents/Github/Thesis/LambdaMatrices/socp`1`_`\
2`.mat\>\"", ",", "K", ",", "gen"}], "]"}], "]"}]}]}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LambdaStar", "=", 
     RowBox[{"Import", "[", "filename", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LambdaStar", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"LambdaStar", ",", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "4"}], ")"}]}]}], "]"}], ",", "1"}], "]"}]}], ";", 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "approximate", " ", "small", " ", "numbers", " ", "by", " ", "zeros"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"LambdaStar", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "x_", "]"}], ":=", 
     RowBox[{"x", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"l1", "[", 
      RowBox[{"x_", ",", "y_", ",", "v_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"LambdaStar", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", 
        RowBox[{"f", "[", "y", "]"}], ",", 
        RowBox[{"f", "[", "w", "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"l2", "[", 
      RowBox[{"x_", ",", "y_", ",", "v_", ",", "w_"}], "]"}], ":=", 
     RowBox[{"LambdaStar", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", 
        RowBox[{"f", "[", "y", "]"}], ",", 
        RowBox[{"f", "[", "w", "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"p", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"K", "+", "1"}], ",", 
         RowBox[{"K", "+", "1"}], ",", 
         RowBox[{"K", "+", "1"}], ",", 
         RowBox[{"K", "+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"var", "=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"f", "[", "i", "]"}], ",", 
           RowBox[{"f", "[", "j", "]"}], ",", "All", ",", "All"}], "]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "K"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"var", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", 
            RowBox[{"f", "[", "i", "]"}], ",", 
            RowBox[{"f", "[", "j", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "K"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Length", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"system", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}], "-", "1"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"q1", "=", "0"}], ",", 
      RowBox[{"q1", "\[LessEqual]", "K"}], ",", 
      RowBox[{"q1", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"z1", "=", "0"}], ",", 
        RowBox[{"z1", "\[LessEqual]", "q1"}], ",", 
        RowBox[{"z1", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"q2", "=", "0"}], ",", 
          RowBox[{"q2", "\[LessEqual]", "K"}], ",", 
          RowBox[{"q2", "++"}], ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"z2", "=", "0"}], ",", 
            RowBox[{"z2", "\[LessEqual]", "q2"}], ",", 
            RowBox[{"z2", "++"}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"system", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"lambda", "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q1", "<", "K"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q1", "-", "z1"}], ")"}], "*", "nu", "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q1", ">", "0"}], "]"}]}], "+", 
                    RowBox[{"z1", "*", "nu", "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z1", ">", "0"}], "]"}]}], "+", 
                    RowBox[{"mu", "*", "z1", "*", 
                    RowBox[{"l1", "[", 
                    RowBox[{"q1", ",", "z1", ",", "q2", ",", "z2"}], "]"}], 
                    "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z1", ">", "0"}], "]"}]}]}], ")"}], "+", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"lambda", "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q2", "<", "K"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "z2"}], ")"}], "*", "nu", "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q2", ">", "0"}], "]"}]}], "+", 
                    RowBox[{"z2", "*", "nu", "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z2", ">", "0"}], "]"}]}], "+", 
                    RowBox[{"mu", "*", "z2", "*", 
                    RowBox[{"l2", "[", 
                    RowBox[{"q1", ",", "z1", ",", "q2", ",", "z2"}], "]"}], 
                    "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z2", ">", "0"}], "]"}]}]}], ")"}]}], ")"}], "*", 
                 
                 RowBox[{"P", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"f", "[", "q1", "]"}], ",", 
                    RowBox[{"f", "[", "z1", "]"}], ",", 
                    RowBox[{"f", "[", "q2", "]"}], ",", 
                    RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}]}], 
                "\[IndentingNewLine]", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"z1", "+", "1"}], ")"}], "*", "nu", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Boole", "[", 
                    RowBox[{"q1", "<", "K"}], "]"}], "*", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q1", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q1", "<", "K"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z1", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z1", "<", "K"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", "q2", "]"}], ",", 
                    RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}]}], ")"}]}], 
                "\[IndentingNewLine]", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"z2", "+", "1"}], ")"}], "*", "nu", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Boole", "[", 
                    RowBox[{"q2", "<", "K"}], "]"}], "*", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", "q1", "]"}], ",", 
                    RowBox[{"f", "[", "z1", "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q2", "<", "K"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z2", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z2", "<", "K"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}]}], ")"}]}], "\[IndentingNewLine]", "-", 
                RowBox[{"lambda", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Boole", "[", 
                    RowBox[{"z1", ">", "0"}], "]"}], "*", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q1", "-", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q1", ">", "0"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z1", "-", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z1", ">", "0"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", "q2", "]"}], ",", 
                    RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}]}], ")"}]}], 
                "\[IndentingNewLine]", "-", 
                RowBox[{"lambda", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Boole", "[", 
                    RowBox[{"z2", ">", "0"}], "]"}], "*", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", "q1", "]"}], ",", 
                    RowBox[{"f", "[", "z1", "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q2", ">", "0"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z2", "-", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z2", ">", "0"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}]}], ")"}]}], "\[IndentingNewLine]", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"q1", "+", "1", "-", "z1"}], ")"}], "*", "nu", "*", 
                 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Boole", "[", 
                    RowBox[{"q1", "<", "K"}], "]"}], "*", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q1", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q1", "<", "K"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", "z1", "]"}], ",", 
                    RowBox[{"f", "[", "q2", "]"}], ",", 
                    RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}]}], ")"}]}], 
                "\[IndentingNewLine]", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"q2", "+", "1", "-", "z2"}], ")"}], "*", "nu", "*", 
                 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Boole", "[", 
                    RowBox[{"q2", "<", "K"}], "]"}], "*", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", "q1", "]"}], ",", 
                    RowBox[{"f", "[", "z1", "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"q2", "<", "K"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}]}], ")"}]}], 
                "\[IndentingNewLine]", "-", 
                RowBox[{"mu", "*", 
                 RowBox[{"(", 
                  RowBox[{"z1", "+", "1"}], ")"}], "*", 
                 RowBox[{"l1", "[", 
                  RowBox[{"q1", ",", 
                   RowBox[{"z1", "+", "1"}], ",", "q2", ",", "z2"}], "]"}], 
                 "*", 
                 RowBox[{"Boole", "[", 
                  RowBox[{"z1", "<", "q1"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", "q1", "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z1", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z1", "<", "q1"}], "]"}]}], "]"}], ",", 
                    RowBox[{"f", "[", "q2", "]"}], ",", 
                    RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}], ")"}]}], 
                "\[IndentingNewLine]", "-", 
                RowBox[{"mu", "*", 
                 RowBox[{"(", 
                  RowBox[{"z2", "+", "1"}], ")"}], "*", 
                 RowBox[{"l2", "[", 
                  RowBox[{"q1", ",", "z1", ",", "q2", ",", 
                   RowBox[{"z2", "+", "1"}]}], "]"}], "*", 
                 RowBox[{"Boole", "[", 
                  RowBox[{"z2", "<", "q2"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"f", "[", "q1", "]"}], ",", 
                    RowBox[{"f", "[", "z1", "]"}], ",", 
                    RowBox[{"f", "[", "q2", "]"}], ",", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z2", "+", "1"}], ")"}], "*", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"z2", "<", "q2"}], "]"}]}], "]"}]}], "]"}], "]"}],
                   ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "]"}]}], "]"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"system", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"system", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"system", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Length", "[", "system", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zeros", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Length", "[", "system", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"system", "\[Equal]", "zeros"}], ",", "var"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psol", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"var", "/.", "sol"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EU1", "=", "0"}], ";", 
    RowBox[{"EU2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"q1", "=", "0"}], ",", 
     RowBox[{"q1", "\[LessEqual]", "K"}], ",", 
     RowBox[{"q1", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"z1", "=", "0"}], ",", 
       RowBox[{"z1", "\[LessEqual]", "q1"}], ",", 
       RowBox[{"z1", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"q2", "=", "0"}], ",", 
         RowBox[{"q2", "\[LessEqual]", "K"}], ",", 
         RowBox[{"q2", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"z2", "=", "0"}], ",", 
           RowBox[{"z2", "\[LessEqual]", "q2"}], ",", 
           RowBox[{"z2", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"EU1", "=", 
             RowBox[{
              RowBox[{"EU1", "+", 
               RowBox[{"z1", "*", 
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"f", "[", "q1", "]"}], ",", 
                   RowBox[{"f", "[", "z1", "]"}], ",", 
                   RowBox[{"f", "[", "q2", "]"}], ",", 
                   RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}]}]}], "/.", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"EU2", "=", 
             RowBox[{
              RowBox[{"EU2", "+", 
               RowBox[{"z2", "*", 
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"f", "[", "q1", "]"}], ",", 
                   RowBox[{"f", "[", "z1", "]"}], ",", 
                   RowBox[{"f", "[", "q2", "]"}], ",", 
                   RowBox[{"f", "[", "z2", "]"}]}], "]"}], "]"}]}]}], "/.", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "EU1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "EU2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.847532312822632*^9, 3.847532327683674*^9}, {
   3.847532433916564*^9, 3.847532436230934*^9}, {3.847532692488696*^9, 
   3.847532703182967*^9}, {3.847533008526866*^9, 3.847533008847109*^9}, {
   3.847540731870595*^9, 3.847540743008431*^9}, {3.84754119623969*^9, 
   3.8475412099230843`*^9}, {3.847541244197462*^9, 3.847541276594293*^9}, {
   3.847541314441882*^9, 3.8475414076532583`*^9}, {3.847541465242708*^9, 
   3.847541489949245*^9}, 3.84754154659338*^9, {3.847541591961604*^9, 
   3.8475416575078287`*^9}, {3.847541768046339*^9, 3.847541776701243*^9}, {
   3.847541844162109*^9, 3.8475418788436813`*^9}, {3.847541914436838*^9, 
   3.847541940400734*^9}, {3.847541983484583*^9, 3.8475419855258493`*^9}, 
   3.8475422031089478`*^9, {3.847542313158783*^9, 3.847542345533828*^9}, 
   3.847542507406155*^9, {3.8475430925761223`*^9, 3.8475431124789886`*^9}, 
   3.847543256523395*^9, {3.847543292745351*^9, 3.847543298659335*^9}, {
   3.847543360605445*^9, 3.8475433607355556`*^9}, 3.847544568951234*^9, {
   3.8475457714629583`*^9, 3.847545775033165*^9}, {3.84786058813125*^9, 
   3.847860596799119*^9}, {3.847860635543315*^9, 3.8478607033995943`*^9}, {
   3.847860760819482*^9, 3.8478607609412403`*^9}, {3.847869336598*^9, 
   3.847869418170731*^9}, {3.8479423480826273`*^9, 3.8479423628899117`*^9}, {
   3.8479433023562393`*^9, 3.8479433358662663`*^9}, {3.847943371982169*^9, 
   3.8479433740767508`*^9}, {3.847947490921742*^9, 3.847947499292602*^9}, {
   3.847948905472537*^9, 3.847948912944765*^9}, 3.847950089197195*^9, 
   3.847950435668745*^9, {3.847951007696218*^9, 3.8479510888940973`*^9}, {
   3.8479513183992653`*^9, 3.847951337566235*^9}, {3.8479515905925903`*^9, 
   3.8479515907525883`*^9}, {3.8479516689778852`*^9, 3.847951770316051*^9}, {
   3.847952017655656*^9, 3.847952034168392*^9}, {3.847952428654168*^9, 
   3.847952428726286*^9}, {3.8480410065405693`*^9, 3.848041032100657*^9}, {
   3.848041088948369*^9, 3.848041092569298*^9}, {3.8480411271920643`*^9, 
   3.848041137743951*^9}, {3.848041379521372*^9, 3.8480414052726088`*^9}, {
   3.848636008302599*^9, 3.848636041500504*^9}, 3.850881473016231*^9, {
   3.850886630155758*^9, 3.850886637204598*^9}, {3.850886678229006*^9, 
   3.850886727827512*^9}, {3.850887467641363*^9, 3.850887567398081*^9}, {
   3.850888928624551*^9, 3.850888937620779*^9}, {3.850888991561805*^9, 
   3.8508890217494087`*^9}, {3.850889098013114*^9, 3.8508891553140793`*^9}, {
   3.8508892093949003`*^9, 3.8508892281034393`*^9}, {3.8508966519414673`*^9, 
   3.850896670530143*^9}, {3.850897064328616*^9, 3.8508970782900257`*^9}, {
   3.85089751541595*^9, 3.850897521209198*^9}, {3.850899806771302*^9, 
   3.85089985495442*^9}, 3.850900352475684*^9, 3.850900393962335*^9, {
   3.8509024963618317`*^9, 3.850902496929735*^9}, {3.850903493798807*^9, 
   3.8509034965580263`*^9}, {3.850903526575028*^9, 3.850903528923298*^9}, 
   3.850904839935623*^9, {3.8511369957229233`*^9, 3.851136996106798*^9}, {
   3.85113723236863*^9, 3.851137242772792*^9}, {3.851137512406708*^9, 
   3.8511375125120573`*^9}, {3.851137703535186*^9, 3.851137704045073*^9}, {
   3.8511379194864683`*^9, 3.8511379205597963`*^9}, {3.855390428365918*^9, 
   3.855390428650998*^9}, {3.85539068001055*^9, 3.855390691790743*^9}, 
   3.8553907247938232`*^9, {3.858053093363586*^9, 3.85805311981271*^9}, {
   3.858053211203679*^9, 3.858053211662957*^9}, 3.8580543244546432`*^9, 
   3.858054798863968*^9, {3.858067622703149*^9, 3.858067627693907*^9}, {
   3.8580681536572437`*^9, 3.858068154472804*^9}, {3.861156051628347*^9, 
   3.861156098911756*^9}, {3.861160316697002*^9, 3.861160318485149*^9}, {
   3.861160368771356*^9, 3.861160409017614*^9}, 3.861160443926941*^9, {
   3.861160513978841*^9, 3.861160532706875*^9}, {3.861160630687592*^9, 
   3.861160632435915*^9}, 3.8611614279955263`*^9, {3.8618685473773537`*^9, 
   3.861868548441698*^9}, {3.865661465614272*^9, 3.8656615886789417`*^9}, 
   3.86566166195033*^9, {3.865664444465991*^9, 3.8656645340593863`*^9}, {
   3.865664733040594*^9, 3.8656647467935963`*^9}, {3.86566479716857*^9, 
   3.865664827826055*^9}, 3.865664858013357*^9, {3.865664894133972*^9, 
   3.8656649161599293`*^9}, 3.865665051741365*^9, 3.86566509384207*^9, 
   3.8656651485633087`*^9, 3.8656651820427523`*^9, {3.865819699087043*^9, 
   3.865819699468831*^9}, {3.865819945442412*^9, 
   3.865819948104166*^9}},ExpressionUUID->"1842bd99-0181-44c4-9355-\
657920c46002"],

Cell[CellGroupData[{

Cell[BoxData["4.246310312116938`"], "Print",
 CellChangeTimes->{
  3.847542234645144*^9, 3.847543122079273*^9, 3.847543162243826*^9, {
   3.847543288030342*^9, 3.8475433042387133`*^9}, 3.8475433617155857`*^9, 
   3.847544576221499*^9, 3.847545779185687*^9, 3.847860601058894*^9, 
   3.8478606663222227`*^9, {3.847860703618491*^9, 3.847860716768483*^9}, 
   3.847860772749922*^9, {3.847869340370842*^9, 3.847869361574389*^9}, {
   3.8478693943321457`*^9, 3.847869418840995*^9}, {3.8479423617286663`*^9, 
   3.847942382149098*^9}, 3.847942726458037*^9, {3.847943317240657*^9, 
   3.8479433249087677`*^9}, {3.847947492119652*^9, 3.8479475001519947`*^9}, 
   3.847947992648882*^9, 3.847948913427853*^9, 3.8479489563337517`*^9, 
   3.847949719112211*^9, 3.847950101479527*^9, 3.84795043627547*^9, 
   3.847950494924726*^9, 3.847950561743655*^9, {3.847951308949079*^9, 
   3.8479513382504787`*^9}, 3.8479515914548197`*^9, {3.84795166956019*^9, 
   3.8479516922518167`*^9}, 3.847951781930088*^9, 3.847952012771194*^9, 
   3.847952399354041*^9, 3.847952448141371*^9, 3.847952614971304*^9, 
   3.847952647510207*^9, 3.847952844400962*^9, 3.848041085131463*^9, {
   3.848041391217366*^9, 3.8480414158323183`*^9}, 3.848635981716905*^9, 
   3.848636057462645*^9, 3.850881384992476*^9, 3.850881483886845*^9, {
   3.850886631425797*^9, 3.850886637728924*^9}, {3.850886679191806*^9, 
   3.850886729019165*^9}, {3.850887469566998*^9, 3.8508875474193907`*^9}, 
   3.8508876158475227`*^9, {3.8508889712149677`*^9, 3.850889022273108*^9}, {
   3.8508891353462467`*^9, 3.8508891564161777`*^9}, {3.850889210224392*^9, 
   3.850889228533903*^9}, 3.850889956832974*^9, {3.8508966542979383`*^9, 
   3.8508966600436497`*^9}, {3.850897057764818*^9, 3.850897090234531*^9}, {
   3.8508975292824097`*^9, 3.850897551201749*^9}, 3.850900063092671*^9, 
   3.8509003713585653`*^9, 3.850900415276498*^9, 3.8509025099075813`*^9, 
   3.8509035147209*^9, 3.8509038284652967`*^9, 3.850904172452976*^9, 
   3.8509048554503*^9, 3.851136873884219*^9, 3.85113701646275*^9, 
   3.8511375432744417`*^9, 3.851137719655972*^9, 3.8511379390057793`*^9, 
   3.855390254557611*^9, 3.855390440617744*^9, 3.8553907060668087`*^9, 
   3.85539073923691*^9, 3.8580526729039*^9, 3.858053143107153*^9, 
   3.8580540221044283`*^9, 3.858054302742009*^9, 3.858054338661214*^9, 
   3.858067871296812*^9, 3.861156227081272*^9, {3.8611578278134747`*^9, 
   3.8611578481105022`*^9}, 3.861160179020165*^9, 3.861160332790925*^9, 
   3.861160380196569*^9, 3.8611604238686323`*^9, 3.861160465818857*^9, {
   3.8611605262423897`*^9, 3.8611605465250263`*^9}, 3.8611606544609756`*^9, 
   3.861161440369055*^9, 3.861868564153666*^9, 3.8656623160819893`*^9, 
   3.865664424127863*^9, 3.865664537534464*^9, 3.8656646362468777`*^9, 
   3.865664756626773*^9, {3.865664819915242*^9, 3.8656648786703176`*^9}, 
   3.8656649175341597`*^9, 3.865665065105298*^9, 3.86566510476807*^9, 
   3.865665159228105*^9, 3.865665196601232*^9},
 CellLabel->
  "During evaluation of \
In[452]:=",ExpressionUUID->"72980371-dc79-4639-9f28-3c61f5761567"],

Cell[BoxData["4.339498975003685`"], "Print",
 CellChangeTimes->{
  3.847542234645144*^9, 3.847543122079273*^9, 3.847543162243826*^9, {
   3.847543288030342*^9, 3.8475433042387133`*^9}, 3.8475433617155857`*^9, 
   3.847544576221499*^9, 3.847545779185687*^9, 3.847860601058894*^9, 
   3.8478606663222227`*^9, {3.847860703618491*^9, 3.847860716768483*^9}, 
   3.847860772749922*^9, {3.847869340370842*^9, 3.847869361574389*^9}, {
   3.8478693943321457`*^9, 3.847869418840995*^9}, {3.8479423617286663`*^9, 
   3.847942382149098*^9}, 3.847942726458037*^9, {3.847943317240657*^9, 
   3.8479433249087677`*^9}, {3.847947492119652*^9, 3.8479475001519947`*^9}, 
   3.847947992648882*^9, 3.847948913427853*^9, 3.8479489563337517`*^9, 
   3.847949719112211*^9, 3.847950101479527*^9, 3.84795043627547*^9, 
   3.847950494924726*^9, 3.847950561743655*^9, {3.847951308949079*^9, 
   3.8479513382504787`*^9}, 3.8479515914548197`*^9, {3.84795166956019*^9, 
   3.8479516922518167`*^9}, 3.847951781930088*^9, 3.847952012771194*^9, 
   3.847952399354041*^9, 3.847952448141371*^9, 3.847952614971304*^9, 
   3.847952647510207*^9, 3.847952844400962*^9, 3.848041085131463*^9, {
   3.848041391217366*^9, 3.8480414158323183`*^9}, 3.848635981716905*^9, 
   3.848636057462645*^9, 3.850881384992476*^9, 3.850881483886845*^9, {
   3.850886631425797*^9, 3.850886637728924*^9}, {3.850886679191806*^9, 
   3.850886729019165*^9}, {3.850887469566998*^9, 3.8508875474193907`*^9}, 
   3.8508876158475227`*^9, {3.8508889712149677`*^9, 3.850889022273108*^9}, {
   3.8508891353462467`*^9, 3.8508891564161777`*^9}, {3.850889210224392*^9, 
   3.850889228533903*^9}, 3.850889956832974*^9, {3.8508966542979383`*^9, 
   3.8508966600436497`*^9}, {3.850897057764818*^9, 3.850897090234531*^9}, {
   3.8508975292824097`*^9, 3.850897551201749*^9}, 3.850900063092671*^9, 
   3.8509003713585653`*^9, 3.850900415276498*^9, 3.8509025099075813`*^9, 
   3.8509035147209*^9, 3.8509038284652967`*^9, 3.850904172452976*^9, 
   3.8509048554503*^9, 3.851136873884219*^9, 3.85113701646275*^9, 
   3.8511375432744417`*^9, 3.851137719655972*^9, 3.8511379390057793`*^9, 
   3.855390254557611*^9, 3.855390440617744*^9, 3.8553907060668087`*^9, 
   3.85539073923691*^9, 3.8580526729039*^9, 3.858053143107153*^9, 
   3.8580540221044283`*^9, 3.858054302742009*^9, 3.858054338661214*^9, 
   3.858067871296812*^9, 3.861156227081272*^9, {3.8611578278134747`*^9, 
   3.8611578481105022`*^9}, 3.861160179020165*^9, 3.861160332790925*^9, 
   3.861160380196569*^9, 3.8611604238686323`*^9, 3.861160465818857*^9, {
   3.8611605262423897`*^9, 3.8611605465250263`*^9}, 3.8611606544609756`*^9, 
   3.861161440369055*^9, 3.861868564153666*^9, 3.8656623160819893`*^9, 
   3.865664424127863*^9, 3.865664537534464*^9, 3.8656646362468777`*^9, 
   3.865664756626773*^9, {3.865664819915242*^9, 3.8656648786703176`*^9}, 
   3.8656649175341597`*^9, 3.865665065105298*^9, 3.86566510476807*^9, 
   3.865665159228105*^9, 3.865665196603396*^9},
 CellLabel->
  "During evaluation of \
In[452]:=",ExpressionUUID->"893e5c99-305a-44b3-a9c6-5750b997af22"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->{},
WindowSize->{1597, 2028},
WindowMargins->{{Automatic, 772}, {Automatic, -1110}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 24856, 562, 1468, "Input",ExpressionUUID->"1842bd99-0181-44c4-9355-657920c46002"],
Cell[CellGroupData[{
Cell[25461, 588, 3054, 44, 29, "Print",ExpressionUUID->"72980371-dc79-4639-9f28-3c61f5761567"],
Cell[28518, 634, 3054, 44, 29, "Print",ExpressionUUID->"893e5c99-305a-44b3-a9c6-5750b997af22"]
}, Open  ]]
}, Open  ]]
}
]
*)

